!function(t,e){"object"==typeof exports&&"object"==typeof module?module.exports=e():"function"==typeof define&&define.amd?define("heartbeat",[],e):"object"==typeof exports?exports.heartbeat=e():t.heartbeat=e()}(self,(function(){return(()=>{"use strict";var t={d:(e,o)=>{for(var n in o)t.o(o,n)&&!t.o(e,n)&&Object.defineProperty(e,n,{enumerable:!0,get:o[n]})},o:(t,e)=>Object.prototype.hasOwnProperty.call(t,e),r:t=>{"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(t,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(t,"__esModule",{value:!0})}},e={};function o(){return function(t){var e=window.location.search;"?"===e[0]&&(e=e.substring(1));var o,n=e.split("&");for(o=0;o<n.length;o+=1){var i=n[o].split("=");if(i[0]===t)return i[1]}return""}("plid")}function n(){var t=window.location.hostname.includes("co.uk")?-3:-2;return window.location.hostname.split(".").slice(t).join(".")}function i(){var t,e,i=(t=window.location.hostname,e=n(),t.replace(".".concat(e),"")),a=n(),r=encodeURIComponent(window.location.pathname+window.location.search),c=window.location.port,u=o(),p="https://sso.".concat(a,"/logout?realm=idp&app=").concat(i,"&path=").concat(r,"&to_generic=true");return c&&(p+="&port=".concat(c)),u&&1!==Number(u)&&(p+="&plid=".concat(u)),p}function a(t){for(var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"",o=document.cookie.split(";"),n=0;n<o.length;n++){var i=o[n].split("="),a=i[0].trim();if(a===t)return decodeURIComponent(i[1])}return e}function r(t,e){if(401===t.status){var o=i();window.location.assign(o)}else if(201===t.status){!function(t,e,o){var n=arguments.length>3&&void 0!==arguments[3]?arguments[3]:31536e3,i=encodeURIComponent(e),a="".concat(t,"=").concat(i,";domain=").concat(o,";max-age=").concat(n,";path=/");document.cookie=a}("info_idp_vat_time",Date.now(),e)}return t}function c(){var t=Number(a("info_idp_vat_time",0));if(Date.now()-t>=23e4){var e={method:"POST",headers:{Accept:"application/json","Content-Type":"application/json"},body:JSON.stringify({infotoken:"true",realm:"idp"}),credentials:"include"},o=n();return fetch("https://sso.".concat(o,"/v1/api/token/ui_heartbeat"),e).then((function(t){return r(t,o)}))}}function u(){if(!window.disableHeartbeat){var t=a("info_idp");t&&function(t){var e=JSON.parse(t),n=e.auth;if("basic"===n||"s2s"===n){if("idp"===e.typ){var i=!0,a=e.plid,r=o();if(r&&Number(a)!==Number(r)&&(i=!1),i)setInterval(c,6e4),c()}}}(t)}}return t.r(e),t.d(e,{checkVat:()=>c,handleVatResult:()=>r,main:()=>u}),u(),e})()}));
//# sourceMappingURL=heartbeat.js.map